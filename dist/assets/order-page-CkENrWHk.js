import{j as e,B as a,I as N,Q as w,c as d,H as D,d as S}from"./index-CGSQnQu3.js";import{f as T}from"./format-time-Di1EMY9f.js";import{r as h}from"./vendor-D10guwLI.js";import{a as k}from"./format-number-DeezL_hy.js";import{e as H}from"./index.es-BVU3MIBu.js";import{c as v}from"./styles-Bw6Lb06x.js";import{a as $,b as B}from"./orders-Dm4iwBlD.js";import{M as r}from"./Modal-uUVsHhbb.js";import"./dayjs.min-DmYrFLVn.js";const F=()=>{const{data:x=[],isLoading:p,refetch:g}=$(),[f]=B(),[s,c]=h.useState({show:!1,id:null,label:"",next:0}),o=(t,n)=>{var l,u,m;const i=`${((l=t.customer)==null?void 0:l.firstName)||""} ${((u=t.customer)==null?void 0:u.lastName)||""}`.trim()||((m=t.customer)==null?void 0:m.phone)||`#${t.id}`;c({show:!0,id:t.id,label:i,next:n})},j=async(t,n)=>{try{await f({id:t,body:{status:n}}).unwrap(),d.success("Success!"),g()}catch{d.error("Có lỗi xảy ra")}},b=()=>{window.open("https://kemnhanonline.vn/api/orders/export","_blank")},y=t=>t===1?"Chờ duyệt":t===2?"Đang giao hàng":t===3?"Hoàn thành đơn":"Từ chối đơn hàng",C=h.useMemo(()=>[{name:"#",selector:(t,n)=>n+1,width:"60px"},{name:"Họ tên",selector:t=>`${t.customer.firstName} ${t.customer.lastName}`,sortable:!0},{name:"Số điện thoại",selector:t=>t.customer.phone,sortable:!0},{name:"Tổng tiền",selector:t=>t.amountTotal,right:!0,cell:t=>e.jsx("span",{children:k(t.amountTotal,{currency:"VND"})})},{name:"Ghi chú",selector:t=>t.note||""},{name:"Ngày đặt",selector:t=>t.createDate,right:!0,cell:t=>e.jsx("span",{children:T(t.createDate,"DD/MM/YYYY")})},{name:"Trạng thái",selector:t=>t.status,cell:t=>e.jsx("span",{children:y(t.status)})},{name:"Chức năng",selector:t=>t.id,cell:t=>{const n=t.status===1?2:t.status===2?3:0;return e.jsxs(e.Fragment,{children:[n?e.jsx(a,{type:"button",className:"btn btn-primary mr-10",onClick:()=>o(t,n),children:t.status===1?"Duyệt đơn hàng":"Đã giao hàng"}):null,t.status!==4&&t.status!==3?e.jsx(a,{type:"button",className:"btn btn-danger",onClick:()=>o(t,4),children:"Từ chối đơn hàng"}):e.jsx("img",{src:N.information,alt:"info",width:20})]})}}],[]);return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between mt-10 mbt-10",children:[e.jsx("h1",{className:"m-0",children:"Danh sách đơn hàng"}),e.jsx("div",{children:e.jsx(a,{variant:"success",type:"button",onClick:b,children:"Xuất Excel"})})]}),e.jsx(w,{autoClose:1e3}),e.jsx(H,{title:"",columns:C,data:x,defaultSortFieldId:"title",pagination:!0,progressPending:p,responsive:!0,dense:!0,customStyles:v}),e.jsxs(r,{show:s.show,onHide:()=>c({show:!1,id:null,label:"",next:0}),centered:!0,backdrop:"static",children:[e.jsx(r.Header,{closeButton:!0,children:e.jsx(r.Title,{children:"Xác nhận cập nhật"})}),e.jsx(r.Body,{children:`Bạn muốn cập nhật trạng thái đơn hàng của "${s.label}"?`}),e.jsxs(r.Footer,{children:[e.jsx(a,{variant:"secondary",type:"button",onClick:()=>c({show:!1,id:null,label:"",next:0}),children:"Huỷ"}),e.jsx(a,{variant:"primary",type:"button",onClick:async()=>{!s.id||!s.next||(await j(s.id,s.next),c({show:!1,id:null,label:"",next:0}))},children:"Xác nhận"})]})]})]})},M={title:`Hóa đơn - ${S.appName}`};function R(){return e.jsxs(e.Fragment,{children:[e.jsx(D,{children:e.jsxs("title",{children:[" ",M.title]})}),e.jsx(F,{})]})}export{R as default};
