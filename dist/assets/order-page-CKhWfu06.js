import{a as D,j as e,B as a,I as S,Q as T,c as h,H,d as k}from"./index-Cisqq87o.js";import{r as d}from"./vendor-D10guwLI.js";import{f as v}from"./format-time-Di1EMY9f.js";import{a as w}from"./format-number-DeezL_hy.js";import{e as $}from"./index.es-3P-hqikk.js";import{c as B}from"./styles-Bw6Lb06x.js";import{a as F,b as M}from"./orders-BB7hcgcg.js";import{M as r}from"./Modal-BE1P8Ww6.js";import"./dayjs.min-DmYrFLVn.js";const E=()=>{const{data:x=[],isLoading:p,refetch:g}=F(),f=D(),[j]=M(),[n,c]=d.useState({show:!1,id:null,label:"",next:0}),o=(t,s)=>{var l,u,m;const i=`${((l=t.customer)==null?void 0:l.firstName)||""} ${((u=t.customer)==null?void 0:u.lastName)||""}`.trim()||((m=t.customer)==null?void 0:m.phone)||`#${t.id}`;c({show:!0,id:t.id,label:i,next:s})},b=async(t,s)=>{try{await j({id:t,body:{status:s}}).unwrap(),h.success("Success!"),g()}catch{h.error("Có lỗi xảy ra")}},y=()=>{f.push("https://kemnhanonline.vn/api/orders/export")},C=t=>t===1?"Chờ duyệt":t===2?"Đang giao hàng":t===3?"Hoàn thành đơn":"Từ chối đơn hàng",N=d.useMemo(()=>[{name:"#",selector:(t,s)=>s+1,width:"60px"},{name:"Họ tên",selector:t=>`${t.customer.firstName} ${t.customer.lastName}`,sortable:!0},{name:"Số điện thoại",selector:t=>t.customer.phone,sortable:!0},{name:"Tổng tiền",selector:t=>t.amountTotal,right:!0,cell:t=>e.jsx("span",{children:w(t.amountTotal,{currency:"VND"})})},{name:"Ghi chú",selector:t=>t.note||""},{name:"Ngày đặt",selector:t=>t.createDate,right:!0,cell:t=>e.jsx("span",{children:v(t.createDate,"DD/MM/YYYY")})},{name:"Trạng thái",selector:t=>t.status,cell:t=>e.jsx("span",{children:C(t.status)})},{name:"Chức năng",selector:t=>t.id,cell:t=>{const s=t.status===1?2:t.status===2?3:0;return e.jsxs(e.Fragment,{children:[s?e.jsx(a,{type:"button",className:"btn btn-primary mr-10",onClick:()=>o(t,s),children:t.status===1?"Duyệt đơn hàng":"Đã giao hàng"}):null,t.status!==4&&t.status!==3?e.jsx(a,{type:"button",className:"btn btn-danger",onClick:()=>o(t,4),children:"Từ chối đơn hàng"}):e.jsx("img",{src:S.information,alt:"info",width:20})]})}}],[]);return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between mt-10 mbt-10",children:[e.jsx("h1",{className:"m-0",children:"Danh sách đơn hàng"}),e.jsx("div",{children:e.jsx(a,{variant:"success",type:"button",onClick:y,children:"Xuất Excel"})})]}),e.jsx(T,{autoClose:1e3}),e.jsx($,{title:"",columns:N,data:x,defaultSortFieldId:"title",pagination:!0,progressPending:p,responsive:!0,dense:!0,customStyles:B}),e.jsxs(r,{show:n.show,onHide:()=>c({show:!1,id:null,label:"",next:0}),centered:!0,backdrop:"static",children:[e.jsx(r.Header,{closeButton:!0,children:e.jsx(r.Title,{children:"Xác nhận cập nhật"})}),e.jsx(r.Body,{children:`Bạn muốn cập nhật trạng thái đơn hàng của "${n.label}"?`}),e.jsxs(r.Footer,{children:[e.jsx(a,{variant:"secondary",type:"button",onClick:()=>c({show:!1,id:null,label:"",next:0}),children:"Huỷ"}),e.jsx(a,{variant:"primary",type:"button",onClick:async()=>{!n.id||!n.next||(await b(n.id,n.next),c({show:!1,id:null,label:"",next:0}))},children:"Xác nhận"})]})]})]})},I={title:`Hóa đơn - ${k.appName}`};function q(){return e.jsxs(e.Fragment,{children:[e.jsx(H,{children:e.jsxs("title",{children:[" ",I.title]})}),e.jsx(E,{})]})}export{q as default};
